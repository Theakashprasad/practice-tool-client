import{aU as v,u as w,r as s,s as N,j as a,b as e,F as k,ao as R,an as D}from"./index-69f66825.js";const C=()=>{v();const p=w(),[l,n]=s.useState(""),[c,d]=s.useState([]),[o,u]=s.useState(!1),[g,x]=s.useState(null),[m,f]=s.useState(5),b=s.useRef(null),h=s.useRef(null);s.useEffect(()=>{p(N("RAG Retrieval"));const r=localStorage.getItem("userData");if(r)try{const t=JSON.parse(r);x(t)}catch(t){console.error("Error parsing user data:",t)}},[]);const i=async r=>{if(r.preventDefault(),!(!l.trim()||o||!g)){u(!0);try{const t=await R.post(`${D}/api/rag/search`,{query:l,topK:m});d(t.data.results)}catch(t){console.error("Error retrieving results:",t),d([{id:"error",score:0,text:"Sorry, there was an error processing your request. Please try again."}])}finally{u(!1)}}},y=r=>{r.key==="Enter"&&!r.shiftKey&&(r.preventDefault(),i(r))};return a("div",{className:"flex flex-col h-[calc(100vh-4rem)] bg-white dark:bg-gray-900",children:[e("div",{className:"border-b border-gray-200 dark:border-gray-700 p-4",children:e("div",{className:"flex items-center justify-between",children:e("div",{className:"flex items-center space-x-4",children:a("select",{value:m,onChange:r=>f(Number(r.target.value)),className:"rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white px-4 py-2",children:[e("option",{value:3,children:"Top 3 Results"}),e("option",{value:5,children:"Top 5 Results"}),e("option",{value:10,children:"Top 10 Results"})]})})})}),g?c.length===0?e("div",{className:"flex-1 flex flex-col items-center justify-center p-4",children:a("div",{className:"text-center max-w-2xl",children:[e("h1",{className:"text-3xl font-bold mb-4 text-gray-900 dark:text-white",children:"RAG Retrieval"}),e("p",{className:"text-gray-600 dark:text-gray-300 mb-8",children:"Enter your query to retrieve relevant information from the knowledge base."}),e("div",{className:"w-full max-w-2xl",children:a("form",{onSubmit:i,className:"relative",children:[e("textarea",{ref:h,value:l,onChange:r=>n(r.target.value),onKeyDown:y,placeholder:"Enter your query here...",className:"w-full p-4 pr-12 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary resize-none",rows:3}),e("button",{type:"submit",disabled:o||!l.trim(),className:"absolute right-4 bottom-4 p-2 rounded-lg bg-primary text-white disabled:opacity-50 disabled:cursor-not-allowed",children:o?a("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})})]})}):a(k,{children:[a("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[c.map((r,t)=>a("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg p-4",children:[a("div",{className:"flex justify-between items-start mb-2",children:[a("span",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:["Result ",t+1]}),a("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Score: ",(r.score*100).toFixed(2),"%"]})]}),e("div",{className:"text-gray-900 dark:text-white whitespace-pre-wrap",children:r.text})]},r.id)),o&&e("div",{className:"flex justify-center",children:e("div",{className:"max-w-3xl rounded-lg p-4 bg-gray-100 dark:bg-gray-800",children:a("div",{className:"flex space-x-2",children:[e("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),e("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}}),e("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.4s"}})]})})}),e("div",{ref:b})]}),e("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4",children:a("form",{onSubmit:i,className:"relative",children:[e("textarea",{ref:h,value:l,onChange:r=>n(r.target.value),onKeyDown:y,placeholder:"Enter your query here...",className:"w-full p-4 pr-12 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-primary resize-none",rows:3}),e("button",{type:"submit",disabled:o||!l.trim(),className:"absolute right-4 bottom-4 p-2 rounded-lg bg-primary text-white disabled:opacity-50 disabled:cursor-not-allowed",children:o?a("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})})]}):e("div",{className:"flex-1 flex items-center justify-center",children:e("div",{className:"text-center p-4",children:e("p",{className:"text-lg text-gray-600 dark:text-gray-300",children:"Please log in to use the RAG retrieval."})})})]})};export{C as default};
